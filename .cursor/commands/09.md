Tarefa 09: Corrigir Lógica de Logout no AuthContext
Objetivo: Garantir que a função signOut no AuthContext.tsx limpe o token de sessão do AsyncStorage E atualize o estado local do utilizador para null, redirecionando-o para a tela de login.

Contexto: O botão "Sair" (provavelmente no app/(tabs)/perfil.tsx) chama a função signOut, mas o aplicativo não está a redirecionar para a tela de login porque o estado user não está a ser limpo.

Modificações no seu contexts/AuthContext.tsx
Instruções:

Abra o ficheiro: AplicativoFIber/contexts/AuthContext.tsx

Encontre a função signOut: Procure pela função signOut (ou handleSignOut) dentro do AuthProvider.

Substitua a função signOut: Substitua a sua função signOut existente por este bloco de código. O ponto crucial é garantir que setUser(null) seja chamado.

TypeScript

// Em: contexts/AuthContext.tsx
// (Dentro do 'AuthProvider')

// ... (procure pela função 'signIn')

// Esta é a função que o seu botão de "Sair" chama
const signOut = async () => {
  try {
    // 1. Chama o authService para limpar o Token JWT do AsyncStorage
    // (Usando a nova 'api' que definimos em 'ixcApi.ts')
    await authService.logout();
  } catch (error) {
    // Mesmo que o 'logout' falhe (ex: AsyncStorage falha),
    // devemos sempre deslogar o utilizador da interface.
    console.error("Erro ao limpar o token no logout:", error);
  } finally {
    // 2. ATUALIZA O ESTADO (O PASSO MAIS IMPORTANTE)
    // Isto diz ao React que o utilizador saiu,
    // fazendo com que a navegação (no app/_layout.tsx) 
    // o redirecione para a tela de login.
    setUser(null);
  }
};

// ... (resto do 'AuthProvider', como o 'return')